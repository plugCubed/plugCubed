/*
 Copyright (c) 2012-2013 by Thomas "TAT" Andresen and other contributors

 Permission to use this software for any purpose without fee is hereby granted, provided
 that the above copyright notice and this permission notice appear in all copies.

 Permission to copy and/or edit this software or parts of it for any purpose is permitted,
 provided that the following points are followed.
 - The above copyright notice and this permission notice appear in all copies
 - Within two (2) days after modification is proven working, any modifications are send back
   to the original authors to be inspected with the goal of inclusion in the official software
 - Any edited version are only test versions and not permitted to be run as a final product
 - Any edited version aren't to be distributed
 - Any edited version have the prerelease version set to something that can be distinguished
   from a version used in the original software

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHORS DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHORS
 BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER
 RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/
var h=void 0,k=!0,l=null,s=!1;"undefined"!==typeof plugCubed&&plugCubed.close();Math.fa=function(){return 1+Math.floor(10*Math.random())};var plugCubed,v,C=s;console.info=function(p){var n;console.log(p);C||(C=k,n=$("#chat-messages"),p=n.scrollTop()>n[0].scrollHeight-n.height()-20,n.append('<div class="chat-update"><span class="chat-text" style="color:#FF0000">'+plugCubed.d("disconnected",plugCubed.S())+"</span></div>"),p&&n.scrollTop(n[0].scrollHeight))};
define("plugCubed/Model","app/base/Class app/facades/ChatFacade app/store/LocalStorage app/utils/Utilities app/models/RoomModel app/base/Context app/events/MediaCurateEvent app/net/Socket app/models/TheUserModel lang/Lang app/views/room/AudienceView".split(" "),function(p,n,e,f,c,m,q,I,O,D,E){function w(a){return"50aeb31696fba52c3ca0adb6"==a}function z(a){return"5112c273d6e4a94ec0554792"==a||"50b1961c96fba57db2230417"==a||"5121578196fba506408bb9eb"==a||"50aeb077877b9217e2fbff00"==a}function t(a,b){if(a){var g=
$("#chat-messages"),d=g.scrollTop()>g[0].scrollHeight-g.height()-20;g.append('<div class="chat-update"><span class="chat-text" style="color:#'+(b?b:"d1d1d1")+'">'+a+"</span></div>");d&&g.scrollTop(g[0].scrollHeight)}}function J(){var a=c.get("description");-1<a.indexOf("@p3=")&&(a=a.substr(a.indexOf("@p3=")+4),-1<a.indexOf(" ")&&a.indexOf(" "),-1<a.indexOf("\n")&&a.indexOf("\n"),t("Loading room settings"),$.getJSON(a,function(a){t("Loaded room settings");$("body").css("background-image",a.background?
"url('"+a.background+"')!important":"")}))}function K(a){var b,g=0<API.getDJs().length&&API.getDJs()[0].id==a.id;b=a.curated!==s?"curate":w(a.id)?"plugcubed":z(a.id)?"vip":API.hasPermission(a.id,API.ROLE.ADMIN)?"admin":API.hasPermission(a.id,API.ROLE.AMBASSADOR)?"ambassador":API.hasPermission(a.id,API.ROLE.HOST)?"host":API.hasPermission(a.id,API.ROLE.COHOST)?"host":API.hasPermission(a.id,API.ROLE.MANAGER)?"manager":API.hasPermission(a.id,API.ROLE.BOUNCER)?"bouncer":API.hasPermission(a.id,API.ROLE.FEATUREDDJ)?
"fdj":"void";if("void"===b)b="void";else{var d;if(g)d="_current";else{d=a.vote;var c="";if(d===h)c="undecided";else switch(d){case -1:c="meh";break;case 1:c="woot";break;default:c="undecided"}d="_"+c}b+=d}L(b,g?"#66FFFF":M(a.vote),a.username)}function M(a){if(a===h)return"FFFFFF";switch(a){case -1:return"ED1C24";case 1:return"3FFF00";default:return"FFFFFF"}}function L(a,b,g){$("#side-left .sidebar-content").append($("<p></p>").append($("<span></span>").append($("<span></span>").addClass(a)).css("cursor",
"pointer").css("color","#"+b).mousedown(function(a){switch(a.which){case 1:$("#chat-input-field").val($("#chat-input-field").val()+"@"+g+" ").focus();break;case 3:(API.hasPermission(h,API.ROLE.BOUNCER)||w(API.getUser().id))&&plugCubed.D(g)}}).html(function(a,b){return b+f.cleanTypedString(23<g.length?g.substr(0,20)+"...":g)})))}function F(){$("#side-left").show().animate({left:"0px"},300,"undefined"===typeof jQuery.easing.V?h:"easeOutQuart")}function N(){var a=-$("#side-left").width()-20;$("#side-left").animate({left:a+
"px"},300,"undefined"===typeof jQuery.easing.V?h:"easeOutQuart",function(){$("#side-left").hide()})}function A(){document.getElementById("chat-sound").playMentionSound()}function G(){if(0!==API.getDJs().length){var a=API.getDJs()[0];a===l||a==API.getUser()||$("#button-vote-positive").click()}}function B(){0<$("#side-left .sidebar-content").children().length&&$("#side-left .sidebar-content").append("<hr />");$("#side-left .sidebar-content").bind("contextmenu",function(){return s});$("#side-left .sidebar-content").html('<h1 class="users">Users: '+
API.getUsers().length+"</h1>");var a=API.getWaitListPosition(),a=$("<h3></h3>").addClass("waitlistspot").text("Waitlist: "+(-1!=a?a+" / ":"")+API.getWaitList().length);$("#side-left .sidebar-content").append(a).append("<hr />");a=API.getUsers();a.sort();a.sort(function(a,b){function c(a){return w(a.id)?20:z(a.id)?19:API.hasPermission(a.id,API.ROLE.ADMIN)?API.ROLE.ADMIN:API.hasPermission(a.id,API.ROLE.AMBASSADOR)?API.ROLE.AMBASSADOR:API.hasPermission(a.id,API.ROLE.HOST)?API.ROLE.HOST:API.hasPermission(a.id,
API.ROLE.COHOST)?API.ROLE.COHOST:API.hasPermission(a.id,API.ROLE.MANAGER)?API.ROLE.MANAGER:API.hasPermission(a.id,API.ROLE.BOUNCER)?API.ROLE.BOUNCER:API.hasPermission(a.id,API.ROLE.FEATUREDDJ)?API.ROLE.FEATUREDDJ:API.ROLE.NONE}var f=c(a),e=c(b);return f<e?1:f>e?-1:0});for(var b in a)K(a[b])}I.listener.chat=function(a){"undefined"!==typeof plugCubed&&-1<plugCubed.settings.ignore.indexOf(a.fromID)||(n.receive(a),API.dispatch(API.CHAT,a))};var y={},x={major:2,minor:0,patch:9,O:"",M:k,toString:function(){return this.major+
"."+this.minor+"."+this.patch+(this.O!==h&&""!==this.O?"-"+this.O:"")+(this.M?"_min":"")}},r=[],H={},u;return p.extend({init:function(){"undefined"===typeof v&&(v={});e.getItem("plugCubedLang")===l||"@@@"===e.getItem("plugCubedLang")||(this.proxy={menu:$.proxy(this.da,this),H:$.proxy(this.H,this),I:$.proxy(this.I,this),G:$.proxy(this.G,this),onUserJoin:$.proxy(this.onUserJoin,this),onUserLeave:$.proxy(this.onUserLeave,this),F:$.proxy(this.F,this),p:$.proxy(this.p,this),onSkip:$.proxy(this.onSkip,
this),onRoomJoin:$.proxy(this.onRoomJoin,this)},$.getScript("https://rawgithub.com/TATDK/plugCubed/2.1.0/langs/lang."+e.getItem("plugCubedLang")+".js",function(){require(["plugCubed/Lang"],function(a){H=a;plugCubed.U()})}),"undefined"===typeof jQuery.fn.tabs&&($.getScript("http://code.jquery.com/ui/1.10.2/jquery-ui.js"),$("head").append('<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />')))},d:function(a){var b=H,g;if(b===h)return"{"+a+"}";a=a.split(".");
for(g in a){if(b[a[g]]===h)return"{"+a.join(".")+"}";b=b[a[g]]}if(1<arguments.length)for(g=1;g<arguments.length;g++)b=b.split("%"+g).join(arguments[g]);return b},U:function(){this.la={};this.colors={ka:"66FFFF",ia:"FF0000",L:"FFFF00",ha:"66FFFF"};this.R=this.d("AFK.default");setTimeout(function(){r=[];var a=API.getHistory(),b;for(b in a){var c=a[b];r.push({id:c.media.id,author:c.media.author,title:c.media.title,J:s,user:{id:c.user.id.toString(),username:c.user.username}})}},1);this.A=$('<style type="text/css" />');
$("head").append(this.A);t(this.d("running",x.toString())+'</span><br /><span class="chat-text" style="color:#66FFFF">'+this.d("commandsHelp"),"FFFF00");window.history&&history.pushState&&function(a){if(this.ea===h){var b=new CustomEvent("pushState"),c=a.pushState;this.ea=k;a.pushState=function(f){window.dispatchEvent(b);return c.apply(a,arguments)};window.addEventListener("pushState",plugCubed.proxy.onRoomJoin)}}(window.history);this.Z();$("body").prepend('<link rel="stylesheet" type="text/css" id="plugcubed-css" href="https://rawgithub.com/TATDK/plugCubed/2.1.0/plugCubed.css" />').prepend('<link rel="stylesheet" type="text/css" id="font-awesome" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css">').append($('<div id="side-left" class="sidebar" />').append($('<div class="sidebar-content" />'))).append($('<div id="side-right" class="sidebar" />').append($('<div class="sidebar-handle"><span>||</span></div>')).append($('<div class="sidebar-content" />'))).append('<script type="text/javascript" src="https://rawgithub.com/TATDK/plugCubed/2.1.0/thirdparty.js">\x3c/script>');
this.X();this.W();var a=API.getUsers(),b;for(b in a)v[a[b].id]===h&&(v[a[b].id]={z:0,u:0,q:0,joinTime:Date.now()});this.settings.userlist&&(B(),F());this.Socket();this.loaded=k;J();$("#footer-links").append($("<div />").addClass("footer").addClass("plugcubed-footer").css("top",12).html(this.d("running",x.toString())+this.d("footer.seperator")).append($("<span />").addClass("plugcubed-status").text(this.d("footer.socket",this.d("footer.unknown")))))},onRoomJoin:function(){"undefined"!==typeof plugCubed&&
setTimeout(function(){if(API.enabled)$.getScript("https://rawgithub.com/TATDK/plugCubed/2.1.0/plugCubed."+(x.M?"min.":"")+"js");else plugCubed.onRoomJoin()},500)},close:function(){if(!(this.loaded===h||this.loaded===s)){API.off(API.CHAT_COMMAND,this.Q);API.off(API.DJ_ADVANCE,this.proxy.H);API.off(API.VOTE_UPDATE,this.proxy.I);API.off(API.CURATE_UPDATE,this.proxy.G);API.off(API.USER_JOIN,this.proxy.onUserJoin);API.off(API.USER_LEAVE,this.proxy.onUserLeave);API.off(API.CHAT,this.proxy.F);API.off(API.VOTE_SKIP,
this.proxy.onSkip);API.off(API.USER_SKIP,this.proxy.onSkip);API.off(API.MOD_SKIP,this.proxy.onSkip);API.off(API.WAIT_LIST_UPDATE,this.proxy.p);for(var a in y)a===h||y[a]===h||($("#plugcubed-btn-"+a).unbind(),delete y[a]);$("#plugcubed-css").remove();$("#font-awesome").remove();$("#plugcubed-js-extra").remove();$("#side-right").remove();$("#side-left").remove();$("#notify-dialog").remove();$(".plugcubed-footer").remove();this.A&&this.A.remove();u&&(u.onclose=function(){},u.close());requirejs.undef("plugCubed/Model");
requirejs.undef("plugCubed/dialog/notify");requirejs.undef("plugCubed/dialog/customChatColors");requirejs.undef("plugCubed/dialog/chatLimit");requirejs.undef("plugCubed/dialog/commands");requirejs.undef("plugCubed/Lang");requirejs.undef("plugCubed/Loader");this.loaded=s;delete plugCubed}},Socket:function(){u===h&&(u=new SockJS("http://socket.plugpony.net:923/gateway"),u.tries=0,u.onopen=function(){this.tries=0;var a=API.getUser();this.send(JSON.stringify({type:"userdata",id:a.id,username:a.username,
room:window.location.pathname.split("/")[1],version:x.toString()}));$(".plugcubed-status").text(plugCubed.d("footer.socket",plugCubed.d("footer.online")))},u.onmessage=function(a){var b=JSON.parse(a.data);a=b.type;b=b.data;if("update"===a)return this.onclose=function(){},this.close(),API.chatLog(plugCubed.d("newVersion"),l,plugCubed.colors.L),setTimeout(function(){$.getScript("https://rawgithub.com/TATDK/plugCubed/2.1.0/plugCubed."+(x.M?"min.":"")+"js")},5E3);if("chat"===a){if(!b.chatID||0<$(".chat-id-"+
b.chatID).length||-1<plugCubed.settings.ignore.indexOf(b.fromID))return;n.receive(b);return API.trigger(API.CHAT,b)}if("rave"===a&&(w(b.id)||API.hasPermission(b.id,API.ROLE.HOST)))return 2>b.value?E.strobeMode(1===b.value):E.lightsOut(k)},u.onclose=function(){this.tries++;var a;if(5>this.tries)a=5;else if(30>this.tries)a=30;else if(60>this.tries)a=60;else return;setTimeout(function(){plugCubed.Socket()},1E3*a);$(".plugcubed-status").text(plugCubed.d("footer.socket",plugCubed.d("footer.offline")))})},
C:{you:{title:"ranks.you",color:"FFDD6F"},regular:{title:"ranks.regular",color:"B0B0B0"},featureddj:{title:"ranks.featureddj",color:"E90E82"},bouncer:{title:"ranks.bouncer",color:"E90E82"},manager:{title:"ranks.manager",color:"E90E82"},cohost:{title:"ranks.cohost",color:"E90E82"},host:{title:"ranks.host",color:"E90E82"},ambassador:{title:"ranks.ambassador",color:"9A50FF"},admin:{title:"ranks.admin",color:"42A5DC"},join:{title:"notify.join",color:"3366FF"},leave:{title:"notify.leave",color:"3366FF"},
curate:{title:"notify.curate",color:"00FF00"},stats:{title:"notify.stats",color:"66FFFF"},updates:{title:"notify.updates",color:"FFFF00"}},settings:{recent:s,awaymsg:"",autowoot:s,autojoin:s,userlist:s,autorespond:s,menu:s,notify:0,customColors:s,emoji:k,avatarAnimations:k,registeredSongs:[],ignore:[],alertson:[],autoMuted:s,chatlimit:{enabled:s,limit:50},colors:{you:"FFDD6F",regular:"B0B0B0",featureddj:"E90E82",bouncer:"E90E82",manager:"E90E82",cohost:"E90E82",host:"E90E82",ambassador:"9A50FF",admin:"42A5DC",
join:"3366FF",leave:"3366FF",curate:"00FF00",stats:"66FFFF",updates:"FFFF00"}},Z:function(){try{var a=JSON.parse(e.getItem("plugCubed")),b;for(b in this.settings)a[b]!==h&&(this.settings[b]=a[b]);this.settings.recent=s;this.settings.autowoot&&G();this.settings.customColors&&this.T();0<this.settings.registeredSongs.length&&-1<this.settings.registeredSongs.indexOf(Models.room.data.media.id)&&(API.setVolume(0),this.settings.autoMuted=k,API.chatLog(this.d("automuted",API.getMedia().title)));if(JSON.parse(e.getItem("stngs")).emoji===
h){var g=JSON.parse(e.getItem("stngs"));g.emoji=k;e.setItem("stngs",JSON.stringify(g),k)}}catch(d){}},saveSettings:function(){e.setItem("plugCubed",JSON.stringify(this.settings))},T:function(){this.settings.customColors?this.A.text([".chat-message .chat-from,",".chat-mention .chat-from { color:#"+this.settings.colors.regular+"!important; }",".chat-message .chat-from-featureddj,",".chat-mention .chat-from-featureddj { color:#"+this.settings.colors.featureddj+"!important; }",".chat-message .chat-from-bouncer,",
".chat-mention .chat-from-bouncer { color:#"+this.settings.colors.bouncer+"!important; }",".chat-message .chat-from-manager,",".chat-mention .chat-from-manager { color:#"+this.settings.colors.manager+"!important; }",".chat-message .chat-from-cohost,",".chat-mention .chat-from-cohost { color:#"+this.settings.colors.cohost+"!important; }",".chat-message .chat-from-host,",".chat-mention .chat-from-host { color:#"+this.settings.colors.host+"!important; }",".chat-message .chat-from-ambassador,",".chat-mention .chat-from-ambassador { color:#"+
this.settings.colors.ambassador+"!important; }",".chat-message .chat-from-admin,",".chat-mention .chat-from-admin { color:#"+this.settings.colors.admin+"!important; }",".chat-message .chat-from-you,",".chat-mention .chat-from-you { color:#"+this.settings.colors.you+"!important; }"].join("\n")):this.A.text("")},W:function(){API.on(API.CHAT_COMMAND,this.Q);API.on(API.DJ_ADVANCE,this.proxy.H);API.on(API.VOTE_UPDATE,this.proxy.I);API.on(API.CURATE_UPDATE,this.proxy.G);API.on(API.USER_JOIN,this.proxy.onUserJoin);
API.on(API.USER_LEAVE,this.proxy.onUserLeave);API.on(API.CHAT,this.proxy.F);API.on(API.VOTE_SKIP,this.proxy.onSkip);API.on(API.USER_SKIP,this.proxy.onSkip);API.on(API.MOD_SKIP,this.proxy.onSkip);API.on(API.WAIT_LIST_UPDATE,this.proxy.p)},X:function(){$("#side-right .sidebar-content").html("");this.k(this.settings.autowoot,"woot",this.d("menu.autowoot"),"heart");this.k(this.settings.autojoin,"join",this.d("menu.autojoin"));this.k(this.settings.userlist,"userlist",this.d("menu.userlist"),"user");this.k(this.settings.customColors,
"colors",this.d("menu.customchatcolors"),"tint");this.k(this.settings.autorespond,"autorespond",this.d("menu.afkstatus"),"reply");this.k(1===(this.settings.notify&1),"notify",this.d("menu.notify"),"warning-sign");this.k(this.settings.chatlimit.enabled,"chatlimit",this.d("menu.limitchatlog"),"ban-circle");this.k(!JSON.parse(e.getItem("stngs")).streamDisabled,"stream",this.d("menu.stream"),"facetime-video");this.k(JSON.parse(e.getItem("stngs")).emoji,"emoji",this.d("menu.emoji"),"smile")},k:function(a,
b,g,d){y[b]===h&&(0<$("#side-right .sidebar-content").children().length&&$("#side-right .sidebar-content").append("<hr />"),$("#side-right .sidebar-content").append('<a id="plugcubed-btn-'+b+'"><div class="status-'+(a?"on":"off")+" icon-"+(d?d:"circle")+'"></div>'+g+"</a>"),$("#plugcubed-btn-"+b).data("key",b).click(this.proxy.menu),y[b]={text:g})},f:function(a,b){$("#plugcubed-btn-"+a).find('[class^="status-"], [class*=" status-"]').removeClass("status-on").removeClass("status-off").addClass("status-"+
(b===k?"on":"off"))},getUser:function(a){a=a.trim();"@"===a.substr(0,1)&&(a=a.substr(1));var b=API.getUsers(),g;for(g in b)if(("string"!==typeof a?0:b[g].username.toLowerCase()===a.toLowerCase())||("string"!==typeof a?0:b[g].id.toLowerCase()===a.toLowerCase()))return b[g];return l},N:function(a,b){if(API.hasPermission(h,API.ROLE.BOUNCER)){var g;switch(b){case "kick":g=API.moderateKickUser;break;case "removedj":g=API.moderateRemoveDJ;break;case "adddj":g=API.moderateAddDJ;break;default:API.chatLog(this.d("error.unknownModeration"));
return}var d=this.getUser(a);d===l?API.chatLog(this.d("error.userNotFound")):g(d.id," ")}},D:function(a){var b=this.getUser(a);if(b===l)API.chatLog(this.d("error.userNotFound"));else{a=v[b.id];var g,d,c,e,q=b.djPoints+b.curatorPoints+b.listenerPoints;d=API.getWaitListPosition(b.id);var m=API.getBoothPosition(b.id);c=API.getDJs();g=API.hasPermission(b.id,API.ROLE.ADMIN)?this.d("ranks.admin"):API.hasPermission(b.id,API.ROLE.AMBASSADOR)?this.d("ranks.ambassador"):API.hasPermission(b.id,API.ROLE.HOST)?
this.d("ranks.host"):API.hasPermission(b.id,API.ROLE.COHOST)?this.d("ranks.cohost"):API.hasPermission(b.id,API.ROLE.MANAGER)?this.d("ranks.manager"):API.hasPermission(b.id,API.ROLE.BOUNCER)?this.d("ranks.bouncer"):API.hasPermission(b.id,API.ROLE.FEATUREDDJ)?this.d("ranks.featureddj"):this.d("ranks.regular");e=0===m?this.d("info.djing"):-1<m?this.d("info.inbooth",m+1,c.length):-1<d?this.d("info.inwaitlist",d,API.getWaitList().length):this.d("info.notinlist");switch(b.status){default:d=this.d("status.available");
break;case API.STATUS.AFK:d=this.d("status.afk");break;case API.STATUS.WORKING:d=this.d("status.working");break;case API.STATUS.SLEEPING:d=this.d("status.sleeping")}switch(b.vote){case -1:c=this.d("vote.meh");break;default:c=this.d("vote.undecided");break;case 1:c=this.d("vote.woot")}0===m&&(c=this.d("vote.djing"));m=h;w(b.id)&&(m=this.d("info.specialTitles.developer"));z(b.id)&&(m=this.d("info.specialTitles.vip"));b='<table style="width:100%;color:#CC00CC"><tr><td colspan="2"><strong>'+this.d("info.name")+
'</strong>: <span style="color:#FFFFFF">'+f.cleanTypedString(b.username)+"</span></td></tr>"+(m?'<tr><td colspan="2"><strong>'+this.d("info.title")+'</strong>: <span style="color:#FFFFFF">'+m+"</span></td></tr>":"")+'<tr><td colspan="2"><strong>'+this.d("info.id")+'</strong>: <span style="color:#FFFFFF">'+b.id+"</span></td></tr><tr><td><strong> "+this.d("info.rank")+'</strong>: <span style="color:#FFFFFF">'+g+"</span></td><td><strong>"+this.d("info.joined")+'</strong>: <span style="color:#FFFFFF">'+
this.S(a.joinTime)+"</span></td></tr><tr><td><strong>"+this.d("info.status")+'</strong>: <span style="color:#FFFFFF">'+d+"</span></td><td><strong> "+this.d("info.vote")+'</strong>: <span style="color:#FFFFFF">'+c+'</span></td></tr><tr><td colspan="2"><strong>'+this.d("info.position")+'</strong>: <span style="color:#FFFFFF">'+e+"</span></td></tr><tr><td><strong>"+this.d("info.points")+'</strong>: <span style="color:#FFFFFF" title = "'+this.d("info.pointType.dj",b.djPoints)+"  +  "+this.d("info.pointType.listener",
b.listenerPoints)+"  +  "+this.d("info.pointType.curator",b.curatorPoints)+'">'+q+"</span></td><td><strong> "+this.d("info.fans")+'</strong>: <span style="color:#FFFFFF">'+b.fans+"</span></td></tr><tr><td><strong>"+this.d("info.wootCount")+'</strong>: <span style="color:#FFFFFF">'+a.z+"</span></td><td><strong>"+this.d("info.mehCount")+'</strong>: <span style="color:#FFFFFF">'+a.u+'</span></td></tr><tr><td colspan="2"><strong>'+this.d("info.ratio")+'</strong>: <span style="color:#FFFFFF">';a:if(g=
a.z,a=a.u,0===a)a=0===g?"0:0":"1:0";else{for(q=1;q<=a;q++)if(m=q*(g/a),0===m%1){a=m+":"+q;break a}a=h}t(b+a+"</span></td></tr></table>")}},da:function(a){a=$(a.currentTarget).data("key");switch(a){case "woot":this.settings.autowoot=!this.settings.autowoot;this.f("woot",this.settings.autowoot);this.settings.autowoot&&$("#button-vote-positive").click();break;case "join":this.settings.autojoin=!this.settings.autojoin;this.f("join",this.settings.autojoin);this.settings.autojoin&&0<$("#button-dj-waitlist-join").length&&
API.djJoin();break;case "userlist":this.settings.userlist=!this.settings.userlist;this.f("userlist",this.settings.userlist);this.settings.userlist?(B(),F()):($("#side-left .sidebar-content").empty(),N());break;case "colors":require(["plugCubed/dialog/customChatColors","app/base/Context","app/events/ShowDialogEvent"],function(a,c,d){c.dispatch(new d(d.SHOW,new a))});break;case "autorespond":this.settings.autorespond=!this.settings.autorespond;this.f("autorespond",this.settings.autorespond);if(this.settings.autorespond){a=
prompt(this.d("AFK.information"),""===this.settings.awaymsg?this.R:this.settings.awaymsg);if(a===l){this.settings.autorespond=s;this.f("autorespond",s);return}a=a.split("@").join("").trim();this.settings.awaymsg=""===a?this.R:a;0>=API.getUser().status&&API.setStatus(API.STATUS.AFK)}else API.setStatus(API.STATUS.AVAILABLE);break;case "notify":require(["plugCubed/dialog/notify","app/base/Context","app/events/ShowDialogEvent"],function(a,c,d){c.dispatch(new d(d.SHOW,new a))});break;case "chatlimit":require(["plugCubed/dialog/chatLimit",
"app/base/Context","app/events/ShowDialogEvent"],function(a,c,d){c.dispatch(new d(d.SHOW,new a))});break;case "stream":return a=JSON.parse(e.getItem("stngs")).streamDisabled,this.f("stream",a),API.sendChat(a?"/stream on":"/stream off");case "emoji":return a=JSON.parse(e.getItem("stngs")).emoji===s,this.f("emoji",a),API.sendChat(a?"/emoji on":"/emoji off");default:return API.chatLog(this.d("menu.unknownMenuKey"))}this.saveSettings()},ja:function(){for(var a in this.settings.colors){var b=$('input[name="'+
a+'"]');b.val(b.data("ph"));b.parents(".dialog-input-container").find(".dialog-input-label").css("color","#"+b.val())}},I:function(a){if(a&&a.user){var b=v[a.user.id];"undefined"===typeof b&&(b=v[a.id]={z:0,u:0,q:0,joinTime:Date.now()});1===b.q?b.z--:-1===b.q&&b.u--;1===a.vote?b.z++:-1===a.vote&&b.u++;b.q=a.vote;this.p()}},G:function(a){var b=API.getMedia();9===(this.settings.notify&9)&&t(this.d("notify.message.curate",f.cleanTypedString(a.user.username),b.author,b.title),this.settings.colors.curate);
this.p()},H:function(a){17===(this.settings.notify&17)&&t(this.d("notify.message.stats",a.lastPlay.score.positive,a.lastPlay.score.negative,a.lastPlay.score.curates),this.settings.colors.stats);33===(this.settings.notify&33)&&t(this.d("notify.message.updates",a.media.title,a.media.author,f.cleanTypedString(a.dj.username)),this.settings.colors.updates);setTimeout($.proxy(this.aa,this),1E3*Math.fa());(API.hasPermission(h,API.ROLE.BOUNCER)||w(API.getUser().id))&&this.ba(a.media.id);50<r.unshift({id:a.media.id,
author:a.media.author,title:a.media.title,J:s,user:{id:a.dj.id,username:a.dj.username}})&&r.splice(50,r.length-50);this.settings.autoMuted&&0>this.settings.registeredSongs.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(plugCubed.lastVolume)},800),this.settings.autoMuted=s);!this.settings.autoMuted&&-1<this.settings.registeredSongs.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(0)},800),this.settings.autoMuted=k,this.lastVolume=API.getVolume(),API.chatLog(i18n("automuted",a.media.title)));
this.p();a=API.getUsers();for(var b in a){if(v[a[b].id]===h)this.onUserJoin(a[b]);v[a[b].id].q=0}},aa:function(){this.settings.autowoot&&0>this.settings.registeredSongs.indexOf(API.getHistory()[0].media.id)&&G();this.settings.autojoin&&("block"===$("#button-dj-play").css("display")||"block"===$("#button-dj-waitlist-join").css("display"))&&API.djJoin()},onUserJoin:function(a){3===(this.settings.notify&3)&&0===c.getUserByID(a.id).get("relationship")&&t(this.d("notify.message.join",f.cleanTypedString(a.username)),
this.settings.colors.join);v[a.id]===h&&(v[a.id]={z:0,u:0,q:0,joinTime:Date.now()});this.p()},onUserLeave:function(a){5===(this.settings.notify&5)&&t(this.d(0===a.relationship?"notify.message.leave.normal":1<a.relationship?"notify.message.leave.friend":"notify.message.leave.fan",f.cleanTypedString(a.username)),this.settings.colors.leave);this.p()},P:function(a){var b="mention"==a.type&&API.hasPermission(a.fromID,API.ROLE.BOUNCER),c=0>a.message.indexOf("@")&&(API.hasPermission(a.fromID,API.ROLE.HOST)||
w(a.fromID));if(b||c)-1<a.message.indexOf("!disable")&&(this.settings.autojoin?(this.settings.autojoin=s,this.f("join",this.settings.autojoin),this.saveSettings(),API.djLeave(),API.sendChat("@"+a.from+" Autojoin disabled")):API.sendChat("@"+a.from+" Autojoin was not enabled")),-1<a.message.indexOf("!afkdisable")&&(this.settings.autorespond?(this.settings.autorespond=s,this.f("autorespond",this.settings.autorespond),this.saveSettings(),API.sendChat("@"+a.from+" AFK message disabled")):API.sendChat("@"+
a.from+" AFK message was not enabled")),0<a.message.indexOf("!disable")||a.message.indexOf("!afkdisable")},F:function(a){a.fromID===API.getUser().id&&u.readyState===SockJS.OPEN&&u.send(JSON.stringify({type:"chat",msg:a.message,chatID:a.chatID}));a.fromID&&-1<this.settings.ignore.indexOf(a.fromID)&&(this.P(a),$(".chat-id-"+a.chatID).remove());this.P(a);if("mention"==a.type)this.settings.autorespond&&!this.settings.recent&&(this.settings.recent=k,setTimeout(function(){plugCubed.settings.recent=s;plugCubed.saveSettings()},
18E4),API.sendChat("@"+a.from+" "+this.settings.awaymsg));else for(var b in this.settings.alertson)-1<a.message.indexOf(this.settings.alertson[b])&&A();if(this.settings.chatlimit.enabled){a=$("#chat-messages").children("div");var c=a.length;b=0;a.each(function(){++b;var a=c-plugCubed.settings.chatlimit.limit-1;b<a?$(this).remove():b==a&&0==b%2&&$(this).remove()})}},p:function(){this.settings.userlist&&B()},onSkip:function(){r[1].J=k},ba:function(a){var b=-1,c;for(c in r){var d=r[c];if(d.id==a&&~~c+
1<r.length&&(b=~~c+2,!d.J))return A(),setTimeout(function(){A()},50),API.chatLog(this.d("historyCheck.inHistory",b,r.length),k)}if(0<b)return API.chatLog(this.d("historyCheck.inHistorySkipped",b,r.length),k)},S:function(a){a=a?new Date(a):new Date;var b=a.getMinutes();return a.getHours()+":"+((10>b?"0":"")+b)},Q:function(a){if(0===a.indexOf("/commands"))return require(["plugCubed/dialog/commands","app/base/Context","app/events/ShowDialogEvent"],function(a,b,c){b.dispatch(new c(c.SHOW,new a))}),k;
if("/avail"==a||"/available"==a)return API.setStatus(0);if("/brb"==a||"/away"==a)API.setStatus(1),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=s,plugCubed.f("join",s),plugCubed.saveSettings());else{if("/work"==a||"/working"==a)return API.setStatus(2);if("/sleep"==a||"/sleeping"==a)return plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=s,plugCubed.f("join",s),plugCubed.saveSettings()),API.setStatus(3);if("/join"==a)return API.djJoin();if("/leave"==a)return API.djLeave();if("/whoami"==
a)return plugCubed.D(API.getUser().id);if("/refresh"==a)return $("#button-refresh").click();if("/version"==a)return API.chatLog(plugCubed.d("running",x.toString()));if("/mute"==a){if(0===API.getVolume())return;plugCubed.lastVolume=API.getVolume();return API.setVolume(0)}if("/link"==a)return API.sendChat("plugCubed : http://plugcubed.com");if("/unmute"==a)return 0<API.getVolume()?API.setVolume(plugCubed.lastVolume):k;if("/nextsong"==a){var b=API.getNextMedia(),g=-1;if(b===h)return API.chatLog(plugCubed.d("noNextSong"));
var b=b.media,d;for(d in r)if(a=r[d],a.id==b.id&&(g=~~d+1,!a.J))return API.chatLog(plugCubed.d("nextsong",b.title,b.author)),API.chatLog(plugCubed.d("isHistory",g,r.length),k);return API.chatLog(plugCubed.d("nextsong",b.title,b.author))}if("/automute"==a){a=API.getMedia();if(a===h)return;0>plugCubed.settings.registeredSongs.indexOf(a.id)?(plugCubed.settings.registeredSongs.push(a.id),plugCubed.settings.autoMuted=k,plugCubed.lastVolume=API.getVolume(),API.setVolume(0),API.chatLog(plugCubed.d("automute.registered",
a.title))):(plugCubed.settings.registeredSongs.splice(plugCubed.settings.registeredSongs.indexOf(API.getMedia().id),1),plugCubed.settings.autoMuted=s,API.setVolume(plugCubed.lastVolume),API.chatLog(plugCubed.d("automute.unregistered",a.title)));return plugCubed.saveSettings()}if("/alertsoff"==a)1===(plugCubed.settings.notify&1)&&(t(plugCubed.d("notify.message.disabled"),plugCubed.colors.L),plugCubed.settings.notify--,plugCubed.f("notify",s));else if("/alertson"==a)1!==(plugCubed.settings.notify&1)&&
(t(plugCubed.d("notify.message.enabled"),plugCubed.colors.L),plugCubed.settings.notify++,plugCubed.f("notify",k));else if(0===a.indexOf("/getpos")){d=plugCubed.getUser(a.substr(8));d=d===l?API.getUser():d;a=API.getWaitListPosition(d.id);if(-1!=a)return API.chatLog(plugCubed.d("info.inwaitlist",a,API.getWaitList.length));a=API.getBoothPosition(d.id);0>a?API.chatLog(plugCubed.d("info.notinlist")):0===a?API.chatLog(plugCubed.d("info.userDjing",d.id===API.getUser().id?plugCubed.d("ranks.you"):f.cleanTypedString(d.username))):
1===a?API.chatLog(plugCubed.d("info.userNextDJ",d.id===API.getUser().id?plugCubed.d("ranks.you"):f.cleanTypedString(d.username))):API.chatLog(plugCubed.d("info.inbooth",a+1,API.getDJs().length))}else if("/curate"==a)for(b in a=JSON.parse(e.getItem("playlist")),a){if(a[b].selected)return m.dispatch(new q(q.CURATE,a[b].id)),k}else{if(0===a.indexOf("/ignore ")||0===a.indexOf("/unignore "))return d=plugCubed.getUser(a.substr(8)),d===l?(API.chatLog(plugCubed.d("error.userNotFound")),k):d.id===API.getUser().id?
(API.chatLog(plugCubed.d("error.ignoreSelf")),k):-1<plugCubed.settings.ignore.indexOf(d.id)?(plugCubed.settings.ignore.splice(plugCubed.settings.ignore.indexOf(d.id),1),plugCubed.saveSettings(),API.chatLog(plugCubed.d("ignore.disabled",d.username)),k):(plugCubed.settings.ignore.push(d.id),plugCubed.saveSettings(),API.chatLog(plugCubed.d("ignore.enabled",f.cleanTypedString(d.username))));if(w(API.ga))return 0===a.indexOf("/whois ")?plugCubed.D(a.substr(7)):k;if(API.hasPermission(h,API.ROLE.BOUNCER)){if(0===
a.indexOf("/skip")){if(1>API.getDJs().length)return;if(0===API.getBoothPosition())return $("#button-skip-this").click();5<a.length&&API.sendChat("@"+API.getDJs()[0].username+" - Reason for skip: "+a.substr(5).trim());return API.moderateForceSkip()}if(0===a.indexOf("/whois "))return plugCubed.D(a.substr(7));if(0===a.indexOf("/kick ")){if(0>a.indexOf("::"))return plugCubed.N(a.substr(6),"kick");a=a.substr(6).split(":: ");d=plugCubed.getUser(a[0]);return API.moderateKickUser(d.id,a[1])}if(0===a.indexOf("/add "))return plugCubed.N(a.substr(5),
"adddj");if(0===a.indexOf("/remove "))return plugCubed.N(a.substr(8),"removedj")}if(API.hasPermission(h,API.ROLE.MANAGER)){if("/lock"===a)return API.moderateRoomProps(k,c.get("waitListEnabled"));if("/unlock"===a)return API.moderateRoomProps(s,c.get("waitListEnabled"))}}}}})});
define("plugCubed/dialog/notify",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(p,n){return p.extend({id:"dialog-notify",className:"dialog",render:function(){return this.$el.append(this.getHeader(plugCubed.d("notify.header"))).append(this.getBody().append('<table style="width: 100%;"><tr><td>'+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(1===(plugCubed.settings.notify&1)?' checked="checked"':"")+' value="1" /></td></tr><tr><td>'+plugCubed.d("notify.join")+
'</td><td align="right"><input type="checkbox" name="join"'+(2===(plugCubed.settings.notify&2)?' checked="checked"':"")+' value="2" /></td></tr><tr><td>'+plugCubed.d("notify.leave")+'</td><td align="right"><input type="checkbox" name="leave"'+(4===(plugCubed.settings.notify&4)?' checked="checked"':"")+' value="4" /></td></tr><tr><td>'+plugCubed.d("notify.curate")+'</td><td align="right"><input type="checkbox" name="curate"'+(8===(plugCubed.settings.notify&8)?' checked="checked"':"")+' value="8" /></td></tr><tr><td>'+
plugCubed.d("notify.stats")+'</td><td align="right"><input type="checkbox" name="songStats"'+(16===(plugCubed.settings.notify&16)?' checked="checked"':"")+' value="16" /></td></tr><tr><td>'+plugCubed.d("notify.updates")+'</td><td align="right"><input type="checkbox" name="songUpdate"'+(32===(plugCubed.settings.notify&32)?' checked="checked"':"")+' value="32" /></td></tr></table>')).append(this.getSubmitButton(n.dialog.ok)),this._super()},submit:function(){plugCubed.settings.notify=0;this.$el.find(":checked").each(function(){plugCubed.settings.notify+=
~~$(this).val()});plugCubed.saveSettings();plugCubed.f("notify",1===(plugCubed.settings.notify&1));this.close()}})});
define("plugCubed/dialog/customChatColors",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(p,n){return p.extend({id:"dialog-custom-colors",className:"dialog",render:function(){var e=$('<table style="width:100%;padding:5px"/>');e.append("<tr><td>"+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(plugCubed.settings.customColors?' checked="checked"':"")+" /></td></tr>");for(var f in plugCubed.C)e.append($("<tr/>").append('<td style="color:#'+plugCubed.settings.colors[f]+
'"><span><strong>'+plugCubed.d(plugCubed.C[f].title)+"</strong></span></td>").append($('<td align="right"></td>').append($('<input type="text" name="'+f+'" value="'+plugCubed.settings.colors[f]+'" placeholder="'+plugCubed.C[f].color+'" />').data("default",plugCubed.C[f].color).css("width","60px").change(function(){$(this).closest("tr").find("span").css("color","#"+$(this).val())}))));return this.$el.append(this.getHeader(plugCubed.d("menu.customchatcolors"))).append(this.getBody().append(e)).append($("<div/>").addClass("dialog-button dialog-default-button").click(function(){$(this).parent().find('input[type="text"]').each(function(){var c=
$(this);c.val(c.data("default"));c.closest("tr").find("span").css("color","#"+c.val())})}).append($("<span/>").text("Default"))).append(this.getCancelButton()).append(this.getSubmitButton(n.dialog.ok)),this._super()},submit:function(){plugCubed.settings.customColors=this.$el.find('input[name="enabled"]').is(":checked");for(var e in plugCubed.settings.colors){var f=this.$el.find('input[name="'+e+'"]'),c=plugCubed.settings.colors,m=e,q;if(!(q=""===f.val()))q=f.val(),q=!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test("#"===
q.substr(0,1)?q:"#"+q);c[m]=q?f.data("default"):f.val()}plugCubed.f("colors",plugCubed.settings.customColors);plugCubed.saveSettings();plugCubed.T();this.close()}})});
define("plugCubed/dialog/chatLimit",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(p,n){return p.extend({id:"dialog-chat-limit",className:"dialog",render:function(){return this.$el.append(this.getHeader(plugCubed.d("menu.limitchatlog"))).append(this.getBody().append('<table style="width: 100%;"><tr><td>'+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(plugCubed.settings.chatlimit.enabled?' checked="checked"':"")+" /></td></tr><tr><td>"+plugCubed.d("limit")+
'</td><td align="right"><input type="text" name="limit" value="'+plugCubed.settings.chatlimit.limit+'" /></td></tr></table>')).append(this.getSubmitButton(n.dialog.ok)),this._super()},submit:function(){var e=this.$el.find('input[name="enabled"]').is(":checked"),f=~~this.$el.find('input[name="limit"]').val();1>f&&(f=1);1024<f&&(e=s,f=1024);plugCubed.settings.chatlimit.enabled=e;plugCubed.settings.chatlimit.limit=f;plugCubed.f("chatlimit",e);plugCubed.saveSettings();if(e){var e=$("#chat-messages").children("div"),
c=e.length,m=0;e.each(function(){++m<c-f&&$(this).remove()})}this.close()}})});
define("plugCubed/dialog/commands",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(p,n){var e=[["/nick","change username"],["/avail","set status to available"],["/afk","set status to afk"],["/work","set status to working"],["/sleep","set status to sleeping"],["/join","join dj booth/waitlist"],["/leave","leaves dj booth/waitlist"],["/whoami","get your own information"],["/mute","set volume to 0"],["/automute","register currently playing song to automatically mute on future plays"],["/unmute",
"set volume to last volume"],["/nextsong","display next song in playlist and if it's in history"],["/refresh","refresh the video"],["/ignore (username)","ignore all chat messages from user"],["/alertson (word)","play mention sound whenever word is written in chat"],["/curate","add current song to your selected playlist"],["/getpos","get current waitlist position"],["/version","displays version number"],["/commands","shows this list"],["/link","paste link to plugCubed website in chat"]],f=[["/whois (username)",
"gives general information about user",API.ROLE.BOUNCER],["/skip","skip current song",API.ROLE.BOUNCER],["/kick (username)","kicks targeted user",API.ROLE.BOUNCER],["/lock","locks DJ booth",API.ROLE.MANAGER],["/unlock","unlocks DJ booth",API.ROLE.MANAGER],["/add (username)","adds targeted user to dj booth/waitlist",API.ROLE.BOUNCER],["/remove (username)","removes targeted user from dj booth/waitlist",API.ROLE.BOUNCER]];return p.extend({id:"dialog-commands",className:"dialog",render:function(){var c=
"<table>",m;for(m in e)c+="<tr><td>"+e[m][0]+"</td><td>"+e[m][1]+"</td></tr>";c+="</table>";if(API.hasPermission(h,API.ROLE.BOUNCER)){c='<div id="plugCubedCommands"><ul><li><a href="#user">'+plugCubed.d("commands.userCommands")+'</a></li><li><a href="#mod">'+plugCubed.d("commands.modCommands")+'</a></li></ul><div id="user">'+c+'</div><div id="mod"><table>';for(m in f)API.hasPermission(h,f[m][2])&&(c+="<tr><td>"+f[m][0]+"</td><td>"+f[m][1]+"</td></tr>");c=$(c+"</table></div></div>").tabs()}return this.$el.append(this.getHeader(plugCubed.d("commands.header"))).append(this.getBody().append(c)).append(this.getSubmitButton(n.dialog.ok)),
this._super()},submit:function(){this.close()}})});
define("plugCubed/Loader",["app/base/Class","plugCubed/Model","app/store/LocalStorage"],function(p,n,e){var f=e.getItem("plugCubedLang");return f!==l&&"@@@"!==f?p.extend({init:function(){plugCubed=new n}}):p.extend({init:function(){$("#overlay-container").append($("#avatar-overlay").clone(s,s).attr("id","plugCubedLang-overlay").width(800).height(600).css("position","absolute"));$("#plugCubedLang-overlay").find(".overlay-title").html("plug&#179; language");$("#plugCubedLang-overlay").find("#avatar-sets").remove();
$("#plugCubedLang-overlay").find("#avatar-panel").attr("id","plugCubedLang-panel").css("padding-top","60px");$("#plugCubedLang-overlay").find(".overlay-close-button").click($.proxy(this.hide,this));this.Y()},show:function(){$("#user-list-overlay").hide();$("#lobby-overlay").hide();$("#media-overlay").hide();$("#avatar-overlay").hide();$("#plugCubedLang-overlay").show();$("#overlay-container").show();this.draw()},hide:function(){$("#user-list-overlay").hide();$("#lobby-overlay").hide();$("#media-overlay").hide();
$("#avatar-overlay").hide();$("#plugCubedLang-overlay").hide();$("#overlay-container").hide()},draw:function(){$("#plugCubedLang-panel").html("").scrollTop(0);var c=this.B.length,e=$("<div/>");if(5<c)for(var f=0;f<c/5;f++)e.append(this.drawRow(this.B.slice(5*f,5*f+5)).css("top",75*f));else e.append(this.drawRow(this.B).css("top",75*f));$("#plugCubedLang-panel").append(e);$(".lang-button").click($.proxy(this.ca,this))},drawRow:function(c){for(var f=$("<div/>").addClass("lang-row"),e=c.length,n=5==
e?0:4==e?75:3==e?150:2==e?225:300,p=0;p<e;++p){var D=$("<div/>").addClass("lang-button").css("display","inline-block").css("left",n).data("language",c[p].file).css("cursor","pointer").append($("<img/>").attr("src","https://rawgithub.com/TATDK/plugCubed/2.1.0/flags/flag."+c[p].file+".png").attr("alt",c[p].name).height(75).width(150));f.append(D);n+=150}return f},ca:function(c){c=$(c.currentTarget);e.setItem("plugCubedLang",c.data("language"),k);plugCubed=new n;this.hide()},Y:function(){var c=this;
this.B=[];$.getJSON("https://rawgithub.com/TATDK/plugCubed/2.1.0/lang.json",function(e){c.B=e;c.show()}).done(function(){0===c.B.length&&log('<span style="color:#FF0000">Error loading plugCubed</span>')})}})});require(["plugCubed/Loader"],function(p){new p});
//# sourceMappingURL=http://tatdk.github.io/plugCubed/compiled/plugCubed.min.js.map 
